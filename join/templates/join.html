{% extends "layout.html" %}
{% block body %}
<div class="jumbotron text-center">
    <h2 class="helper-title">Interested in joining</h2>
    <h1 class="title">Stuyvesant Key Club?</h1>
    <img class="img-responsive center-block" src="/images/logo.png" alt="Key Club Logo" />
</div>
<div class="row">
<div class="col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2" id="join-container">
    <form id="join-form" class="form-horizontal" action="/submit" method="post">
        <div class="form-group">
            <label for="inputName" class="col-sm-3 control-label">Name</label>
            <div class="col-sm-7">
                <input type="text" class="form-control" id="inputName" name="name" placeholder="Full Name" autofocus autocomplete="off">
            </div>
        </div>
        <div class="form-group">
            <label for="inputId" class="col-sm-3 control-label">4 Digit ID</label>
            <div class="col-sm-3">
                <input type="text" class="form-control" id="inputId" maxlength="4" name="id" placeholder="ID" autocomplete="off">
            </div>
        </div>
        <div class="form-group">
            <label for="inputEmail" class="col-sm-3 control-label">Email</label>
            <div class="col-sm-7">
                <input type="email" class="form-control" id="inputEmail" name="email" placeholder="Email Address" autocomplete="off">
                <span id="emailHelpBlock" class="help-block text-danger" style="display:none;">Are you sure that this email is valid?</span>
            </div>
        </div>
        <button type="submit" id="submit-button" class="col-sm-6 col-sm-offset-3 btn btn-primary" data-loading-text="Submitting...">Submit</button>
    </form>
</div>
</div>
<div class="spinner-background">
    <div class="spinner">
        <div class="dot1"></div>
        <div class="dot2"></div>
    </div>
</div>

{% endblock %}
{% block scripts %}
<script>
$('#inputId').keydown(function(event) {
    return event.which < 58 || (event.which >= 96 && event.which <= 105);
});
var isFormGood = false;
$(document).ready(function() {
    $('button[type="submit"]').prop('disabled', true);
    $('#join-form').one('submit', function() {
        $('.spinner-background').show();
        $('input').each(function() {$(this).prop('readonly', true);});
        $('#submit-button').button('loading');
    });
});
$('input').keyup(function() {
    $('input').each(function() {
        if ($(this).val()) {
            isFormGood = true;
        }
        else {
            isFormGood = false;
            return false;
        }
    });
    if (isFormGood) {
        $('button[type="submit"]').prop('disabled', false);
    }
    else {
        $('button[type="submit"]').prop('disabled', true);
    }
});
var re = /^([a-zA-Z0-9+_\-\.])+@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,6})$/;
$('#inputEmail').keyup(function() {
    if (re.test($(this).val())) {
        $('#emailHelpBlock').fadeOut();
        $('button[type="submit"]').prop('disabled', false);
    }
    else {
        $('#emailHelpBlock').fadeIn();
        $('button[type="submit"]').prop('disabled', true);
    }
});
</script>
{% endblock %}
